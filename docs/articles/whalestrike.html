<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using the whalestrike package • whalestrike</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the whalestrike package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">whalestrike</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/whalestrike.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/whalestrike/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using the whalestrike package</h1>
                        <h4 data-toc-skip class="author">Dan Kelley (<a href="https://orcid.org/0000-0001-7808-5911" class="external-link uri">https://orcid.org/0000-0001-7808-5911</a>)</h4>
            
            <h4 data-toc-skip class="date">2026-02-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dankelley/whalestrike/blob/HEAD/vignettes/whalestrike.Rmd" class="external-link"><code>vignettes/whalestrike.Rmd</code></a></small>
      <div class="d-none name"><code>whalestrike.Rmd</code></div>
    </div>

    
    
<!-- HOW TO BUILD THE VIGNETTE. -->
<!-- 1. edit this file in vignettes/whalestrike.Rmd -->
<!-- 2. run devtools::build_vignettes() -->
<!-- 3. build the package -->
<p><strong>Abstract.</strong> This vignette explains the basics of using
the whalestrike package to simulate the collision of a ship with a
whale.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package solves Newton’s second law for a simple model of a ship
colliding with a whale. This is a stripped-down model that does not
attempt to simulate the biomechanical interactions that can be simulated
in finite-element treatments such as that of Raymond (2007). The goal is
to establish a convenient framework for rapid computation of impacts in
a wide variety of conditions. The model runs quickly enough to keep up
with mouse movements to select conditions, in a provided R shiny
application called <code><a href="../reference/app.html">app()</a></code>. With this application, users can
see the effects of changing contact area, ship speed, etc., as a way to
build intuition for scenarios ranging from collision with a slow-moving
fishing boat to collision with a thin dagger-board of a much swifter
racing sailboat.</p>
<p>The documentation for <code><a href="../reference/strike.html">strike()</a></code> provides an example of
using the main functions of this package, and so it is a good place to
start. Two companion manuscripts (see Further Reading) provide more
detail about the analysis and the context.</p>
</div>
<div class="section level2">
<h2 id="gui-usage">GUI usage<a class="anchor" aria-label="anchor" href="#gui-usage"></a>
</h2>
<p>The following launches a GUI application that should be somewhat
self-explanatory.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/whalestrike/">whalestrike</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/app.html">app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>To learn more, try the above, and then click the icon next to the
word “Whale” in the side panel, and select “N. Atl. Right. Whale” in
that pulldown menu. You will see a view as is shown below. Note that
there are sliders to permit adjustment of whale length, and the
thickesses of the four sublayers in the model. Try adjusting them,
paying attention to the effects on the graphs (particularly the “Lethal
Index” graph). Then, with these whale parameters set, try expanding the
“Ship” item in the side panel, perhaps exploring the effect of ship
mass. Having built intution from this, try adjusting the ship speed.
Note, through all of these tests, that there are many choices for the
panels to show in the plot area.</p>
<p><img src="app_narw.png"></p>
</div>
<div class="section level2">
<h2 id="non-gui-usage">Non-GUI usage<a class="anchor" aria-label="anchor" href="#non-gui-usage"></a>
</h2>
<div class="section level3">
<h3 id="overview-plot">Overview plot<a class="anchor" aria-label="anchor" href="#overview-plot"></a>
</h3>
<p>The following shows how to run a simulation and produce a simple
summary plot. (Setting the second argument of <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> gives
access to about a dozen plot types.) The left panel shows position of
ship as a dashed curve, while the whale is indicated with three curves,
the top being an imagined point mass in the whale interior, the one
below it being the interface between sub-layer and blubber, and the one
below that being the whale skin. (Actually, the skin is so thin that
what seems to be a thick line is actually two lines.) The impact occurs
when the ship line contacts the whale-skin line, at about 0.3s, and
lasts about 0.5s.</p>
<p>The middle shows a cross section of whale skin, blubber and
sub-layer. Note the thinning of the bottom two layers, indicative of
high compressive stress associated with the impact of the boat.</p>
<p>The right panel shows the Lethality Index (LI), a quantity that was
devised by examination of the published reports of whale strikes. In the
analysis, reports of “No Injury” and “Minor Injury” were assessed as
having a lethality of 0, while reports of “Severe Injury” or “Mortality”
were assigned as having a lethality of 1. These observed lethalities
were then fitted with a logistic model as a function of the base-10
logarithm of the maximum compressive stress during a simulation of the
event using [strike()], using published or inferred whale and ship
characteristics. Simulations in which the peak LI exceeds 0.5, as in the
case shown below, are indicative of serious risk to the life of the
whale.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/whalestrike/">whalestrike</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: bslib</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'bslib'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:utils':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     page</span></span>
<span><span class="co">#&gt; Loading required package: deSolve</span></span>
<span><span class="co">#&gt; Loading required package: shiny</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span>, vs <span class="op">=</span> <span class="fu"><a href="../reference/knot2mps.html">knot2mps</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, xw <span class="op">=</span> <span class="fl">0</span>, vw <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># 10 knot ship</span></span>
<span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># defaults</span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strike.html">strike</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">state</span>, <span class="va">parms</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></span></code></pre></div>
<p><img src="whalestrike_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" width="672"></p>
<p><strong>Exercises.</strong> Rerun the simulation with different
parameters, e.g. (1) lower the speed until the peak LI is below 0.5, (2)
vary whale length to consider the effects of strikes on immature
animals, and (3) model strikes near the mandible, by altering the
thickness, modulus, and strength of the sublayer. (See the documentation
for <a href="../help/parameters">parameters</a> to learn how to set the
relevant parameters of the ship and whale, and use that for <a href="../help/strike">strike</a> to learn about setting vessel speed and
the simulation time interval.)</p>
</div>
<div class="section level3">
<h3 id="threat-dependence-on-impact-area">Threat dependence on impact area<a class="anchor" aria-label="anchor" href="#threat-dependence-on-impact-area"></a>
</h3>
<p>This example shows how to extract information from a sequence of
simulations, to create a graphical display that is not part of the
default list. For clarity, this is done with a loop rather than using
e.g <code>lapply</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/whalestrike/">whalestrike</a></span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, vs <span class="op">=</span> <span class="fu"><a href="../reference/knot2mps.html">knot2mps</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, xw <span class="op">=</span> <span class="fl">0</span>, vw <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># 10 knots</span></span>
<span><span class="va">area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">stress</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="co"># compressive stress [MPa]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">area</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span>Ly <span class="op">=</span> <span class="va">L</span>, Lz <span class="op">=</span> <span class="va">L</span><span class="op">)</span></span>
<span>    <span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strike.html">strike</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">state</span>, <span class="va">parms</span><span class="op">)</span></span>
<span>    <span class="va">stress</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sol</span><span class="op">$</span><span class="va">WCF</span><span class="op">$</span><span class="va">stress</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning in strike(t, state, parms): increasing from 200 to 4772 time steps, to capture acceleration peak</span></span>
<span><span class="va">danger</span> <span class="op">&lt;-</span> <span class="va">parms</span><span class="op">$</span><span class="va">s</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">stress</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Area [m^2]"</span>, ylab <span class="op">=</span> <span class="st">"Stress [MPa]"</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">stress</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">area</span><span class="op">[</span><span class="va">stress</span> <span class="op">&gt;=</span> <span class="va">danger</span><span class="op">]</span>, <span class="va">stress</span><span class="op">[</span><span class="va">stress</span> <span class="op">&gt;=</span> <span class="va">danger</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">danger</span>, lty <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Compression stress [MPa]\n(injurious if &gt; %.2f MPa)"</span>, <span class="va">danger</span><span class="op">)</span>,</span>
<span>    side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="whalestrike_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="672"></p>
<p><strong>Exercise.</strong> Look at the help for
<code><a href="../reference/plot.strike.html">plot.strike()</a></code>, to learn how to examine skin stress in the y
and z directions separately, and then explore the effect of adjusting
impact geometry, at constant area.</p>
</div>
<div class="section level3">
<h3 id="threat-dependence-on-blubber-thickness-and-ship-speed">Threat dependence on blubber thickness and ship speed<a class="anchor" aria-label="anchor" href="#threat-dependence-on-blubber-thickness-and-ship-speed"></a>
</h3>
<p>This example shows how to create a matrix of simulation results, in
order to display dependence of a result upon two parameters. Here, the
display shows the maximum compressive strain as a function of ship speed
and blubber thickness. Note that the contour lines are thickened when
the strain exceeds an estimate of the ratio of blubber ultimate tensile
strength to blubber modulus.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/whalestrike/">whalestrike</a></span><span class="op">)</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co"># Hint: the following creates x and y of different lengths,</span></span>
<span><span class="co"># so that mismatches between row/col and i/j values will</span></span>
<span><span class="co"># yield errors.</span></span>
<span><span class="va">l2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.25</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># blubber thickness</span></span>
<span><span class="va">speedK</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">15</span>, length.out <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># in knots</span></span>
<span><span class="va">speed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/knot2mps.html">knot2mps</a></span><span class="op">(</span><span class="va">speedK</span><span class="op">)</span></span>
<span><span class="co"># stress = peak stress during each simulation, in MPa</span></span>
<span><span class="va">stress</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">l2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">l</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">l2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">speed</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xs <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, vs <span class="op">=</span> <span class="va">speed</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, xw <span class="op">=</span> <span class="fl">0</span>, vw <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parameters.html">parameters</a></span><span class="op">(</span>l <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">l</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">l2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">l</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">l</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strike.html">strike</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">state</span>, <span class="va">parms</span><span class="op">)</span></span>
<span>        <span class="va">stress</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sol</span><span class="op">$</span><span class="va">WCF</span><span class="op">$</span><span class="va">stress</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">danger</span> <span class="op">&lt;-</span> <span class="va">parms</span><span class="op">$</span><span class="va">s</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">speedK</span>, <span class="va">l2</span>, <span class="va">stress</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">danger</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Speed [knots]"</span>, ylab <span class="op">=</span> <span class="st">"Blubber thickness [m]"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">speedK</span>, <span class="va">l2</span>, <span class="va">stress</span>, level <span class="op">=</span> <span class="va">danger</span>, lty <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">speedK</span>, <span class="va">l2</span>, <span class="va">stress</span>, level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">danger</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>    <span class="st">"Compression stress [MPa]\n(injurious if &gt; %.2f MPa, dashed contour)"</span>,</span>
<span>    <span class="va">danger</span></span>
<span><span class="op">)</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="whalestrike_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="672"></p>
<p><strong>Exercise.</strong> Explore the effect of varying sublayer
properties and thickness on this graph.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p>The documentation for the <code>whalestrike</code> package provides
many references to the literature. A good start is to use
<code><a href="../reference/strike.html">help("strike",package="whalestrike")</a></code> to get help on a key
function of the package.</p>
<p>For more on the science involved, see Kelley, Dan E., James P.
Vlasic, and Sean W. Brillant. “Assessing the Lethality of Ship Strikes
on Whales Using Simple Biophysical Models.” Marine Mammal Science 37,
no. 1 (January 2021): 251-67. <a href="https://doi.org/10.1111/mms.12745" class="external-link uri">https://doi.org/10.1111/mms.12745</a>.</p>
<p>For more on the computing aspects, see Kelley, D. E., (2024).
“whalestrike: An R package for simulating ship strikes on whales.”
Journal of Open Source Software, 9(97), 6473, <a href="https://doi.org/10.21105/joss.06473" class="external-link uri">https://doi.org/10.21105/joss.06473</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
